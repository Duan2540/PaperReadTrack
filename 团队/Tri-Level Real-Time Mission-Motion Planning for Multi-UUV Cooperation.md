## <span style="color:blue">一、摘要</span>

本文开发了RAMMP三层优化模型，用于解决多UUV在大规模时变环境下的协同任务。\*\*\*上层指挥官同步信息，中层负责任务分配与序列规划（*任务规划器本身是 “搭载在 UAV 上” 的，可以获取外部环境的完全信息*），下层执行路径避障与实时控制（运动规划器是搭载在UUV上的，观测的是局部信息）。\*\*\*该系统利用启发式算法，通过分解复杂任务实现了高效的实时响应与低能耗路径规划。

## <span style="color:blue">二、场景以及任务目标</span>

这篇文章描述的具体场景是**多无人水下航行器（UUV）在广阔且时变的海洋环境中执行协作访问任务**，例如进行周期性维护或科学观测。  以下是根据来源对该场景的详细拆解：

### 1\. 核心任务：顺序访问与节点匹配

* **任务对象：** 一支 UUV 集群（由母船/载体派出）需要访问一组均匀分布在海上的**监测站（Marine Stations）**。  
* **访问逻辑：** 这是一个典型的**车辆路径规划问题（VRP）的变体**。每个站点必须被访问且**仅能被访问一次**。  
* **匹配与分配：** 系统的“使命规划层”负责根据全局信息，为每台 UUV 设计平衡的**站点分配模式**以及经济的**访问顺序**。  
* **闭环路径：** 所有 UUV 必须从同一个载体出发，并在完成任务后返回该载体。

### 2\. 任务目标：最小化能量消耗与负载均衡

* **首要目标：** 整个规划器（RAMMP）的核心目标是以**最小的总能量消耗**完成所有站点的访问任务。  
* **次要目标（负载均衡）：** 为了提高效率并确保任务成功，系统还追求 UUV 之间的**负载平衡**（Load Balance），防止某些 UUV 因任务过重而耗尽能量，而其他 UUV 却过早返回。  
* **时间效率：** 系统通过减少 UUV 在站点等待信息同步的时间来优化效率，确保 UUV 尽量在相近的时间到达站点。

### 3\. 环境背景：复杂且动态的海洋

* **地理范围：** 任务发生在广阔的海域（案例研究中为 30 × 22.5 km²），包含海岸线、岛屿等地形。  
* **动态干扰：** 环境中存在**时变洋流（Time-varying currents）和动态障碍物**（如敌方侦察船或鱼群）。  
* **洋流利用：** UUV 不仅要避开障碍物，还需要实时调整姿态，以**利用有利洋流并抵御不利洋流**，从而实现节能。

### 4\. 实时协作场景示例

来源提供了一个生动的示例：

* 最初，系统可能根据全局洋流预测只需派出一台 UUV1 即可完成任务。  
* 但在实际航行中，如果遇到强力涡流（Vortex）导致 UUV1 绕路并消耗了超出预期的能量，**指挥层**会实时介入并重新规划。  
* 系统随后会指派第二台 UUV2 加入协作，共同分担剩余的站点访问任务，以确保整体任务能够安全、经济地完成。

综上所述，该场景不仅是简单的节点匹配，更是一个在**能量受限**和**环境高度不确定**条件下，追求**系统总能耗最低**和**成员负载均衡**的动态协作过程。

## <span style="color:blue">三、三层的输入输出</span>

我们可以把这三层看作一个企业的“CEO”、“部门经理”和“一线员工”。  
以下是根据来源整理的每一层的输入与输出：

### 1\. 上层：指挥官 (The Upper-Level / Commander)

**职责：** 负责全局协调、时间同步和信息存储。它不负责具体的路线怎么画，而是决定“什么时候该谁干活”,,。

* \*\*输入：**来自**使命层（ML）\*\*的最优访问序列和任务分配结果,。  
* 来自\*\*运动层（LL）\*\*的实时路径点、当前位置和实际消耗的能量,,。  
* **输出：给使命层：** 触发信号（当UUV到达站点时，命令其根据最新能量和环境重新规划全盘任务）,,。  
* **给运动层：** 当前航段的起点和终点指令,。  
* **给系统：** 存储并同步所有UUV的最新状态（如剩余能量、已访问站点列表）,。

### 2\. 中层：使命规划器 (The Middle-Level / Mission Planner)

**职责：** 负责“分工”和“排班”。在考虑全局洋流风险的前提下，决定哪台UUV去哪几个站，按什么顺序去最划算,。

* **输入：来自上层：** 已访问站点、UUV当前停靠位置、可用UUV数量及其剩余能量,,。  
* **来自无人机 (UAV)：** 全局海洋洋流信息,,。  
* **来自运动层 (预计算)：** 任意两个站点之间避开陆地的**最短安全距离** $d\_{ij}^\*$,,。  
* **输出：最优使命方案：** 包含每台UUV负责的站点分配模式和详细的访问顺序序列,,。  
* **分值：** 当前方案的预期总成本（距离与洋流风险的加权和）,。

### 3\. 底层：运动规划器 (The Lower-Level / Motion Planner)

**职责：** 负责“走路”和“看路”。它要应对具体的洋流和突然出现的障碍物，找一条最省电的路,。

* **输入：来自上层/中层：** 当前需要航行的起点和终点坐标,。  
* **来自自身传感器：** 局部探测范围内的实时洋流速度、方向，以及动态障碍物信息,,,。  
* **来自静态地图：** 海岸线和岛屿的地形数据,,。  
* **输出：给中层 (任务前)：** 所有站点间的最短无碰撞路径距离数据,,。  
* **给上层 (任务中)：** 每一个运动时间步（如30分钟）内最节能的路径点序列，以及这段时间消耗的**实际电量**,,。

### 直观总结

* **上层 (UL)** 输入的是**反馈**，输出的是**指令和同步**。  
* **中层 (ML)** 输入的是**全局情报和状态**，输出的是**任务清单**,。  
* **底层 (LL)** 输入的是**导航点和局部感官**，输出的是**具体轨迹和能耗记录**,,。

## <span style="color:blue">四、三层之间的配合以及对文中两种时间的例子解释</span>

假设：运动时间间隔 Δt=30 分钟（固定），初始任务时间 T₀触发时，任务规划器给 UUV₁分配 “从载体→站点 14” 的任务。

#### 步骤 1：T₀时刻（任务时间触发）

* 任务规划器（UAV 上）：基于全局海流，确定 UUV₁的目标是站点 14，预估需要 2 个运动时间间隔（即 ΔT₀=2×30=60 分钟）完成这段路程，将 “起点 \= 载体、终点 \= 站点 14” 发送给 UUV₁的运动规划器。  
* 同步动作：上层指挥官记录 “ΔT₀=60 分钟”，告知运动规划器 “需在 2 个 Δt 内抵达站点 14”。

#### 步骤 2：t₀时刻（第一个运动时间触发，T₀后的第 0-30 分钟）

* 运动规划器（UUV₁上）：基于当前局部海流、障碍，规划 “接下来 30 分钟的路径”（比如避开小涡旋，走低速流区），UUV₁按此路径航行 30 分钟，到达 “中途点 A”。  
* 同步动作：运动规划器向指挥官反馈 “已航行 30 分钟，剩余路程需再 1 个 Δt”。

#### 步骤 3：t₁时刻（第二个运动时间触发，T₀后的第 30-60 分钟）

* 运动规划器（UUV₁上）：更新局部环境信息（比如发现新的动态障碍），规划 “接下来 30 分钟的路径”（调整方向，仍瞄准站点 14），UUV₁航行 30 分钟后，**准时抵达站点 14**。  
* 同步动作：运动规划器向指挥官反馈 “已抵达站点 14，剩余能量 80%”。

#### 步骤 4：T₁时刻（新的任务时间触发）

* 因为 UUV₁抵达站点 14，触发新的任务时间 T₁（ΔT₀=60 分钟结束）。  
* 任务规划器（UAV 上）：基于 UUV₁的实时状态（能量、位置）和全局海流更新，重新决策 —— 将 UUV₁的下一个目标从 “站点 03” 改为 “站点 15”（避涡旋），并告知运动规划器新的 “起点 \= 站点 14、终点 \= 站点 15”。  
* 同步动作：指挥官重新计算 ΔT₁=k₁×30 分钟（比如预估需要 3 个 Δt，即 90 分钟），再次同步给运动规划器。

*在上述过程中，中层的任务规划器只会给出下一阶段任务的预估时间，把这个预估时间回传给上层的指挥官后，指挥官会根据下层的运动规划器的算出的实际执行时间作为该阶段任务的执行时间。*

## <span style="color:blue">五、上层不包含决策变量的原因</span>

你的观察非常敏锐。在来源提供的数学模型中，**式（3）确实不直接包含决策变量 $x\_{ijk}^u$**。这反映了该三层优化模型中“指挥官层（UL）”独特的运作逻辑。  
以下是根据来源对这一现象的详细解释：

### 1\. 式（3）刻画的是“结果的累加”，而非“求解过程”

式（3）的内容为 $F_u^m = \sum_{ii \in T} F_{ii}^{m*}$。

* 这里的 *$F_{ii}^{m}$*\* 是使命规划层（ML）在第 $ii$ 个时间步算出的**最优目标值**（Scalar Value）。  
* 由于指挥官层（UL）被定义为是一个“**目标函数求解问题**”，它并不在这一层级进行数千次的迭代求解，而是负责**评估、管理和同步**。因此，式（3）的作用是统计整个任务执行下来的总成本，而不是作为寻优的函数。

### 2\. $x_{ijk}^u$ 的角色是“信息存储器”

决策变量 $x_{ijk}^u$ 出现在式（5）中，而非式（3）。

* **式（5）的含义：** $x_{ijk}^u(T_{ii}) = f_1(\arg \min F_{ii}^m)$。  
* 这表示 $x_{ijk}^u$ 是通过一个映射函数 $f_1$，从使命层（ML）的**最优解**（即 $\arg \min F_{ii}^m$）中提取出来的。  
* 在使命层（ML）内部，真正的决策变量是 **$x_{ijk}^m$**（用于决定 UUV $k$ 是否从 $i$ 去 $j$）。当 ML 完成优化后，指挥官层（UL）就把这个结果“抓取”过来，存储在 $x_{ijk}^u$ 中，用来指导接下来的运动规划。

### 3\. 为什么这样设计？

来源解释了这种设计的必要性：

* **解耦与并行：** 指挥官层忽略了任务分配和路径生成的具体技术细节，专注于**同步（Synchronization）和存储（Storage）**。  
* **实时性要求：** 通过将“寻找最优动作（$x$）”的过程下放到中层（ML）和下层（LL），指挥官层（UL）只需要在特定的时间步（$T_{ii}$）记录下那些已经被算好的最优动作即可。

### 总结

你之所以在式（3）中看不到 $x_{ijk}^u$，是因为：

* **式（3）** 负责把**分值**（$F^*$）加起来，用于评估总能耗。  
* **式（5）** 负责把**动作**（$x$）存起来，用于指挥 UUV 行动。

在三层架构中，指挥官层通过约束条件（式 5）要求自己存储的变量必须是中层优化的结果，从而间接实现了对整个系统目标的优化。

## <span style="color:blue">六、上层的作用</span>

• **充当“粘合剂”和“调度员”：**  
◦ UL 负责**时间同步**。它管理使命时间步（Tii）和运动时间步（tjj）的切换。  
◦ 例如，只有当 UUV 到达某个站点时，UL 才会触发中层（ML）重新规划；而在航行过程中，UL 则定期触发底层（LL）避障。  
• **信息存储与状态更新：**  
◦ UL 负责保存和更新 UUV 的状态（如剩余能量、已访问站点）。  
◦ 它将中层的最优解（去哪个站）转化为底层的输入指令（起点和终点），并将底层的实际能耗反馈给中层。  
• **实现动态协作的关键：**  
◦ **无需迭代的原因：** 优化搜索的过程已经下放给了中层的模拟退火算法（SA）和底层的差分进化算法（DE）。UL 只需要执行一次逻辑判断：**“当前环境是否发生重大变化？是否需要重新调用中层？”**  
◦ **实例体现：** 来源中提到，当 UUV1 因为绕路导致能耗超过预期时，是上层（UL）捕捉到了这一信息，并决定重新调用中层（ML）分配 UUV2 加入任务。如果没有 UL 的实时监控，系统将无法响应这种突发环境变化。  
**总结：** UL 是整个系统的\*\*“大脑皮层”**，它不负责搬运具体的数学计算（迭代），而是负责决策**“什么时候该算什么”\*\*，并将各个部分的处理结果拼凑成一个完整的、实时的任务链条。通过这种分解，复杂的任务被拆解为简单的并行子问题，这才是 RAMMP 实现“低延迟、实时性”的根本原因。  
